let LocalCertList = externaldata (
FileName: string,
SubjectCN: string,
Category: string
)
["https://raw.githubusercontent.com/LimoWagdy/Thesis/refs/heads/main/Certs/Gaming.csv"]
with (format='csv', ignoreFirstRecord=true);

DeviceFileCertificateInfo
| join kind=leftouter (
	LocalCertList
) on $left.Signer == $right.SubjectCN
| extend Gaming = iff(isnotempty(SubjectCN) and Category == "Gaming", 1, 0)
| project DeviceId, FileName, Signer, Gaming
